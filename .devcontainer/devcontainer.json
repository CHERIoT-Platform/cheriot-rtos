{
  "image": "ghcr.io/cheriot-platform/devcontainer:latest",
  "remoteUser": "cheriot",
  "containerUser": "cheriot",
  "onCreateCommand": "git config --global --add safe.directory /workspaces/cheriot-rtos && git submodule update --init --recursive && for dir in tests tests.extra/*/ ex*/[[:digit:]]* ; do (echo Generating compile_commands.json for $dir; cd $dir && xmake f --sdk=/cheriot-tools/ && xmake project -k compile_commands); done",
  "customizations": {
    "vscode": {
      "extensions": [
          "llvm-vs-code-extensions.vscode-clangd",
          "tboox.xmake-vscode",
          "hnw.vscode-auto-open-markdown-preview"
      ],
      "settings": {
        "clangd.path": "/cheriot-tools/bin/clangd",
        "xmake.compileCommandsDirectory": "${workspaceRoot}",
        "xmake.workingDirectory": "${workspaceRoot}/tests",
        "xmake.additionalConfigArguments": "--sdk=/cheriot-tools/"
      }
    }
  }
}

